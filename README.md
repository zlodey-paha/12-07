# Домашнее задание к занятию «Репликация и масштабирование. Часть 2»

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;

*Дайте ответ в свободной форме.*

### Решение 1

- активный master-сервер и пассивный репликационный slave-сервер:
Разделение нагрузки: Весь трафик на запись направляется на один master-сервер, считывающие запросы можно распределить между несколькими slave-серверами.
Повышение пропускной способности: новые slave-серверы линейно увеличивают производительность для обработки считывающих операций.
Резервная копия в реальном времени: Slave-сервер постоянно синхронизирован с master-ом и является его актуальной копией.
"Горячее" резервирование: Поскольку slave уже запущен и работает, он не требует времени на восстановление из бэкапа. Процедура переключения (failover) занимает минуты, а не часы.

- master-сервер и несколько slave-серверов
Распределение нагрузки по "веерному" принципу. Возможно добавить 2, 3, 5 slave-серверов. Поток запросов на чтение равномерно распределяется между ними через балансировщик нагрузки.
Линейный рост производительности. Каждый новый сервер увеличивает общую мощность по обработке запросов на чтение.
Резервирование "N+1". При трех slave-серверах один выходит из строя, система продолжает работать без заметных проблем.
Гибкость при обслуживании. Можно поочередно выводить slave-серверы из эксплуатации для обновления оборудования.

---

### Задание 2

Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блок-схему, где и что будет располагаться. Опишите, в каких режимах будут работать серверы.* 

### Решение 2

#### Принципы построения распределенной системы баз данных
Каждая база данных отвечает за определенный тип данных.
Связанные данные хранятся близко друг к другу для минимизации сетевых издержек.
Каждый компонент системы может масштабироваться независимо от других.

#### Вертикальное разделение
Аутентификация и пользователи. Все, что связано с идентификацией, аутентификацией и авторизацией
Каталог товаров. Данные товаров, их классификация и контент
Коммерция и транзакции. Транзакционные данные, заказы, платежи

#### Горизонтальное разделение
Шардирование по географическому признаку
Шардирование по жанрам и популярности
Шардирование по регионам и временным периодам

```
+-----------------------+
|   База данных: auth   |  ← Вертикальный шард
+-----------------------+
| - users (primary)     |
| - sessions            |
| - auth_tokens         |
+-----------------------+

+-----------------------+
| База данных: catalog  |  ← Вертикальный шард
+-----------------------+
| - books               |
| - authors             |
| - genres              |
| - reviews             |
+-----------------------+

+-----------------------+
| База данных: commerce |  ← Вертикальный шард
+-----------------------+
| - stores              |
| - inventory           |
| - orders              |
| - payments            |
+-----------------------+
```

---

## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

---
### Задание 3*

Выполните настройку выбранных методов шардинга из задания 2.

*Пришлите конфиг Docker и SQL скрипт с командами для базы данных*.
